<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.possys.Payment_service.Payment_Mapper">

<!-- payment 중복 체크 쿼리 만듦 -->
<select id="check_pid" parameterType = "String" resultType="int">
SELECT count(*) FROM payment WHERE 1=1 AND payment_id = #{payment_id}
</select>

<update parameterType="kr.or.possys.Payment_service.Payment" id="updatePayment"> 
UPDATE payment SET payment_id = #{payment_id} , table_order_id = #{table_order_ID} 
WHERE payment_id = #{payment_id}</update>

<delete parameterType="kr.or.possys.Payment_service.Payment" id="deletePayment"> 
DELETE FROM payment WHERE payment_id = #{payment_id} </delete>

<select id="paymentSRsearch" parameterType="java.util.Map" resultType="kr.or.possys.Payment_service.Payment">
SELECT
payment_id,
table_order_id,
payment_total,
payment_pay,
payment_date,
payment_cate,
payment_state 
FROM payment
WHERE ${select} LIKE CONCAT('%',#{keyWord},'%')
ORDER BY payment_id DESC 
LIMIT #{beginRow}, #{pagePerRow}
</select>

<!-- 결제목록 검색 수 -->
<select id="paymentSRlist" parameterType="java.util.Map" resultType="int">
	SELECT COUNT(*) FROM payment WHERE ${select} LIKE CONCAT('%',#{keyWord},'%')
</select>

<!-- 뷰파일로 DB에서 결제테이블 전체의 내용 가져오기 -->
<select parameterType="String" id="getPayment" resultType="kr.or.possys.Payment_service.Payment"> 
SELECT * FROM payment WHERE payment_id = #{payment_id}</select>

<!-- 결제내역 리스트 화면에 표시할 내용 DB에서 가져오기 -->
<select parameterType="java.util.Map" id="getPaymentList" resultType="kr.or.possys.Payment_service.Payment"> 
SELECT 
payment_id,
table_order_id,
payment_total,
payment_pay,
payment_date,
payment_cate,
payment_state 
FROM payment 
ORDER BY payment_id DESC LIMIT #{beginRow}, #{pagePerRow}
</select>

<!-- 결제내역 카운트 -->
<select id="getPaymentCount" resultType="int"> 
SELECT COUNT(*) FROM payment 
</select>

<!-- 결제목록 입력 -->
 <insert parameterType="kr.or.possys.Payment_service.Payment" id="insertPayment">
<!-- <insert id="kr.or.possys.Payment_service.Payment" parameterType="insertPayment">  -->
 INSERT INTO payment(payment_id
 , table_order_id 
 , member_phone
 , payment_total
 , payment_pay
 , payment_addmileage
 , payment_usemileage
 , payment_date
 , payment_cate
 , payment_state) 
 
 VALUES( #{payment_id} 
 , #{table_order_id} 
 , #{member_phone} 
 , #{payment_total} 
 , #{payment_pay} 
 , #{payment_addmileage}
 , #{payment_usemileage}
 , #{payment_date}
 , #{payment_cate}
 , #{payment_state}) 
 </insert>

</mapper>